if (strncmp(req, "GET /value", strlen("GET /value")) == 0)
{
char json[128];
int len = snprintf(json, sizeof(json),
"{"
"\"value\": %u," // original 24-bit packed value
"\"led_state\": %d," // NEW
"\"temp_raw\": %u" // NEW
"}",
(unsigned)((current_led_byte << 16) | current_temp_raw), (int)current_led_byte, (unsigned)current_temp_raw); char
    header[128]; int hlen=snprintf(header,
    sizeof(header), "HTTP/1.1 200 OK\r\n" "Content-Type: application/json\r\n" "Content-Length: %d\r\n" "Connection: close\r\n\r\n"
    , len); tcp_write(pcb, header, hlen, TCP_WRITE_FLAG_COPY); tcp_write(pcb, json, len, TCP_WRITE_FLAG_COPY);
    tcp_output(pcb); tcp_close(pcb); return ERR_OK; }